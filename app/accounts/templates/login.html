{% load static %}
<link rel="stylesheet" href="{% static 'login.css' %}">

<html>

<head>
  <meta charset="utf-8">
  <title>Login</title>
</head>

<body>
  <h2>Login</h2>

  {% if form.errors %}
  <p style="color:red;">Invalid username or password.</p>
  {% endif %}

  <!-- <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Sign in</button>
  </form> -->

  <!-- <p>No account yet? <a href="{% url 'signup' %}">Create one</a></p> -->

  {% load socialaccount %}
  <a href="{% provider_login_url 'google' %}">Sign in with Google</a>

  <p><a id="toggle-link">Switch to Moderator</a></p>

  <script>

    document.addEventListener('DOMContentLoaded', function () {

      const link = document.getElementById('toggle-link');
      const titleLine = document.querySelector('h2');

      let isProfile = localStorage.getItem('dashboardMode') !== 'moderator'; // default true if not 'moderator'

      function updateLink() {
        if (isProfile) {
          link.textContent = 'Switch to Moderator';
          titleLine.textContent = 'Login to Dashboard';
        } else {
          link.textContent = 'Switch to Dashboard';
          titleLine.textContent = 'Login to Moderator';
        }
      }

      updateLink();

      if (!window.location.search) {
        if (isProfile) {
          window.location.search = '?next=/dashboard/';
        } else {
          window.location.search = '?next=/accounts/moderator/dashboard/';
        }
      }

      link.addEventListener('click', function (event) {
        event.preventDefault();
        isProfile = !isProfile;
        localStorage.setItem('dashboardMode', isProfile ? 'profile' : 'moderator');
        if (isProfile) {
          window.location.search = '?next=/dashboard/';
        } else {
          window.location.search = '?next=/accounts/moderator/dashboard/';
        }
      });

    });

  </script>

</body>

</html>